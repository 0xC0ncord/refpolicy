## <module name="kernel">
## <summary>
##	Policy for kernel threads, proc filesystem, 
##	and unlabeled processes and objects.
## </summary>

########################################
## <interface name="kernel_userland_entry">
## 	<desc>
##		Allows to start userland processes
##		by transitioning to the specified domain.
## 	</desc>
## 	<param name="domain">
##		The process type entered by kernel.
## 	</param>
## 	<param name="entrypoint">
##		The executable type for the entrypoint.
## 	</param>
## </interface>
#
interface(`kernel_userland_entry',`
	gen_require(`
		type kernel_t;
		class process sigchld;
		class fifo_file rw_file_perms;
		class fd use;
	')

	domain_auto_trans(kernel_t, $2, $1)

	allow $1 kernel_t:fd use;
	allow kernel_t $1:fd use;
	allow kernel_t $1:fifo_file rw_file_perms;
	allow $1 kernel_t:process sigchld;
')

########################################
## <interface name="kernel_rootfs_mountpoint">
##	<desc>
## 		Allows the kernel to mount filesystems on
## 		the specified directory type.
##	</desc>
##	<param name="directory_type">
##		The type of the directory to use as a mountpoint.
##	</param>
## </interface>
#
interface(`kernel_rootfs_mountpoint',`
	gen_require(`
		type kernel_t;
		class dir mounton;
	')

	allow kernel_t $1:dir mounton;
')

########################################
## <interface name="kernel_sigchld">
## 	<desc>
##		Send a SIGCHLD signal to kernel threads.
## 	</desc>
## 	<param name="domain">
## 		The type of the process sending the signal.
## 	</param>
## </interface>
#
interface(`kernel_sigchld',`
	gen_require(`
		type kernel_t;
		class process sigchld;
	')

	allow kernel_t $1:process sigchld;
')

########################################
## <interface name="kernel_share_state">
## 	<desc>
## 		Allows the kernel to share state information with
## 		the caller.
## 	</desc>
## 	<param name="domain">
## 		The type of the process with which to share state information.
## 	</param>
## </interface>
#
interface(`kernel_share_state',`
	gen_require(`
		type kernel_t;
		class process share;
	')

	allow kernel_t $1:process share;
')

########################################
## <interface name="kernel_use_fd">
## 	<desc>
## 		Permits caller to use kernel file descriptors.
## 	</desc>
## 	<param name="domain">
## 		The type of the process using the descriptors.
## 	</param>
## </interface>
#
interface(`kernel_use_fd',`
	gen_require(`
		type kernel_t;
		class fd use;
	')

	allow $1 kernel_t:fd use;
')

########################################
## <interface name="kernel_dontaudit_use_fd">
## 	<desc>
## 		Do not audit attempts to use
## 		kernel file descriptors.
## 	</desc>
## 	<param name="domain">
## 		The type of process not to audit.
##	</param>
## </interface>
#
interface(`kernel_dontaudit_use_fd',`
	gen_require(`
		type kernel_t;
		class fd use;
	')

	dontaudit $1 kernel_t:fd use;
')

########################################
## <interface name="kernel_load_module">
##	<desc>
## 		Allows caller to load kernel modules
##	</desc>
##	<param name="domain">
##		The process type to allow to load kernel modules.
##	</param>
## </interface>
#
interface(`kernel_load_module',`
	gen_require(`
		attribute can_load_kernmodule;
		class capability sys_module;
	')

	allow $1 self:capability sys_module;
	typeattribute $1 can_load_kernmodule;
')

########################################
## <interface name="kernel_read_ring_buffer">
##	<desc>
## 		Allows caller to read the ring buffer.
##	</desc>
##	<param name="domain">
##		The process type allowed to read the ring buffer.
##	</param>
## </interface>
#
interface(`kernel_read_ring_buffer',`
	gen_require(`
		type kernel_t;
		class system syslog_read;
	')

	allow $1 kernel_t:system syslog_read;
')

########################################
## <interface name="kernel_dontaudit_read_ring_buffer">
##	<desc>
## 		Do not audit attempts to read the ring buffer.
##	</desc>
##	<param name="domain">
##		The domain to not audit.
##	</param>
## </interface>
#
interface(`kernel_dontaudit_read_ring_buffer',`
	gen_require(`
		type kernel_t;
		class system syslog_read;
	')

	dontaudit $1 kernel_t:system syslog_read;
')

########################################
## <interface name="kernel_change_ring_buffer_level">
##	<desc>
## 		
##	</desc>
##	<param name="domain">
##		
##	</param>
## </interface>
#
interface(`kernel_change_ring_buffer_level',`
	gen_require(`
		type kernel_t;
		class system syslog_console;
	')

	allow $1 kernel_t:system syslog_console;
')

########################################
## <interface name="kernel_clear_ring_buffer">
##	<desc>
## 		Allows the caller to clear the ring buffer.
##	</desc>
##	<param name="domain">
##		The process type clearing the buffer.
##	</param>
## </interface>
#
interface(`kernel_clear_ring_buffer',`
	gen_require(`
		type kernel_t;
		class system syslog_mod;
	')

	allow $1 kernel_t:system syslog_mod;
')

########################################
## <interface name="kernel_get_sysvipc_info">
##	<desc>
## 		Get information on all System V IPC objects.
##	</desc>
##	<param name="domain">
##		
##	</param>
## </interface>
#
interface(`kernel_get_sysvipc_info',`
	gen_require(`
		type kernel_t;
		class system ipc_info;
	')

	allow $1 kernel_t:system ipc_info;
')

########################################
## <interface name="kernel_read_system_state">
##	<desc>
## 		Allows caller to read system state information.
##	</desc>
##	<param name="domain">
##		The process type reading the system state information.
##	</param>
## </interface>
#
interface(`kernel_read_system_state',`
	gen_require(`
		type proc_t;
		class dir r_dir_perms;
		class lnk_file { getattr read };
		class file r_file_perms;
	')

	allow $1 proc_t:dir r_dir_perms;
	allow $1 proc_t:lnk_file { getattr read };
	allow $1 proc_t:file r_file_perms;
')

########################################
## <interface name="kernel_dontaudit_read_system_state">
##	<desc>
## 		Do not audit attempts by caller to 
## 		read system state information.
##	</desc>
##	<param name="domain">
##		The process type not to audit.
##	</param>
## </interface>
#
interface(`kernel_dontaudit_read_system_state',`
	gen_require(`
		type proc_t;
		class file read;
	')

	allow $1 proc_t:file read;
')

#######################################
## <interface name="kernel_read_software_raid_state">
##	<desc>
## 		Allow caller to read the state information for software raid.
##	</desc>
##	<param name="domain">
##		The process type reading software raid state.
##	</param>
## </interface>
#
interface(`kernel_read_software_raid_state',`
	gen_require(`
		type proc_t, proc_mdstat_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir r_dir_perms;
	allow $1 proc_mdstat_t:file r_file_perms;
')

########################################
## <interface name="kernel_getattr_core">
##	<desc>
## 		Allows caller to get attribues of core kernel interface.
##	</desc>
##	<param name="domain">
##		The process type getting the attibutes.
##	</param>
## </interface>
#
interface(`kernel_getattr_core',`
	gen_require(`
		type proc_t, proc_kcore_t;
		class dir { search getattr read };
		class file getattr;
	')

	allow $1 proc_t:dir r_dir_perms;
	allow $1 proc_kcore_t:file getattr;
')

########################################
## <interface name="kernel_dontaudit_getattr_core">
##	<desc>
## 		Do not audit attempts to get the attributes of 
## 		core kernel interfaces.
##	</desc>
##	<param name="domain">
##		The process type to not audit.
##	</param>
## </interface>
#
interface(`kernel_dontaudit_getattr_core',`
	gen_require(`
		type proc_kcore_t;
		class file getattr;
	')

	dontaudit $1 proc_kcore_t:file getattr;
')

########################################
## <interface name="kernel_read_messages">
##	<desc>
## 		Allow caller to read kernel messages
##		using the /proc/kmsg interface.
##	</desc>
##	<param name="domain">
##		The process type reading the messages.
##	</param>
## </interface>
#
interface(`kernel_read_messages',`
	gen_require(`
		attribute can_receive_kernel_messages;
		type proc_kmsg_t, proc_t;
		class dir search;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 proc_kmsg_t:file r_file_perms;
	typeattribute $1 can_receive_kernel_messages;
')

########################################
## <interface name="kernel_getattr_message_if">
##	<desc>
## 		Allow caller to get the attributes of kernel message
## 		interface (/proc/kmsg).
##	</desc>
##	<param name="domain">
##		The process type getting the attributes.
##	</param>
## </interface>
#
interface(`kernel_getattr_message_if',`
	gen_require(`
		type proc_kmsg_t, proc_t;
		class dir search;
		class file getattr;
	')

	allow $1 proc_t:dir search;
	allow $1 proc_kmsg_t:file getattr;
')

########################################
## <interface name="kernel_dontaudit_getattr_message_if">
##	<desc>
## 		Do not audit attempts by caller to get the attributes of kernel 
## 		message interfaces.
##	</desc>
##	<param name="domain">
##		The process type not to audit.
##	</param>
## </interface>
#
interface(`kernel_dontaudit_getattr_message_if',`
	gen_require(`
		type proc_kmsg_t, proc_t;
		class file getattr;
	')

	dontaudit $1 proc_kmsg_t:file getattr;
')

########################################
## <interface name="kernel_read_network_state">
##	<desc>
## 		Allow caller to read the network state information.
##	</desc>
##	<param name="domain">
##		The process type reading the state.
##	</param>
## </interface>
##
#
interface(`kernel_read_network_state',`
	gen_require(`
		type proc_t, proc_net_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 proc_net_t:dir r_dir_perms;
	allow $1 proc_net_t:file r_file_perms;
')

########################################
## <interface name="kernel_dontaudit_search_sysctl_dir">
##	<desc>
## 		Do not audit attempts by caller to search the sysctl directory.
##	</desc>
##	<param name="domain">
##		The process type not to audit.
##	</param>
## </interface>
##
#
interface(`kernel_dontaudit_search_sysctl_dir',`
	gen_require(`
		type sysctl_t;
		class dir search;
	')

	dontaudit $1 sysctl_t:dir search;
')

########################################
## <interface name="kernel_read_device_sysctl">
##	<desc>
## 		Allow caller to read the device sysctls.
##	</desc>
##	<param name="domain">
##		The process type to allow to read the device sysctls.
##	</param>
## </interface>
#
interface(`kernel_read_device_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_dev_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_dev_t:dir r_dir_perms;
	allow $1 sysctl_dev_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_device_sysctl">
##	<desc>
## 		Read and write device sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_device_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_dev_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_dev_t:file rw_file_perms;
')

########################################
## <interface name="kernel_read_vm_sysctl">
##	<desc>
## 		Allow caller to read virtual memory sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
##
#
interface(`kernel_read_vm_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_vm_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_vm_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_vm_sysctl">
##	<desc>
## 		Read and write virtual memory sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_vm_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_vm_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_vm_t:file rw_file_perms;
')

########################################
## <interface name="kernel_dontaudit_search_network_sysctl_dir">
##	<desc>
## 		Do not audit attempts by caller to search sysctl network directories.
##	</desc>
##	<param name="domain">
##		The process type not to audit.
##	</param>
## </interface>
#
interface(`kernel_dontaudit_search_network_sysctl_dir',`
	gen_require(`
		type sysctl_net_t;
		class dir search;
	')

	dontaudit $1 sysctl_net_t:dir search;
')

########################################
## <interface name="kernel_read_net_sysctl">
##	<desc>
## 		Allow caller to read network sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
##
#
interface(`kernel_read_net_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_net_t;
		class dir r_dir_perms;
		class file f_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_net_t:dir r_dir_perms;
	allow $1 sysctl_net_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_net_sysctl">
##	<desc>
## 		Allow caller to modiry contents of sysctl network files.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_net_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_net_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_net_t:dir r_dir_perms;
	allow $1 sysctl_net_t:file rw_file_perms;
')

########################################
## <interface name="kernel_read_unix_sysctl">
##	<desc>
## 		Allow caller to read unix domain
##		socket sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_read_unix_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_net_t, sysctl_net_unix_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_net_t:dir r_dir_perms;
	allow $1 sysctl_net_unix_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_unix_sysctl">
##	<desc>
## 		Read and write unix domain
##		socket sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_unix_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_net_t, sysctl_net_unix_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_net_t:dir r_dir_perms;
	allow $1 sysctl_net_unix_t:file rw_file_perms;
')

########################################
## <interface name="kernel_read_hotplug_sysctl">
##	<desc>
## 		Read the hotplug sysctl.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_read_hotplug_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_kernel_t, sysctl_hotplug_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_kernel_t:dir r_dir_perms;
	allow $1 sysctl_hotplug_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_hotplug_sysctl">
##	<desc>
## 		Read and write the hotplug sysctl.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_hotplug_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_kernel_t, sysctl_hotplug_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_kernel_t:dir r_dir_perms;
	allow $1 sysctl_hotplug_t:file rw_file_perms;
')

########################################
## <interface name="kernel_read_modprobe_sysctl">
##	<desc>
## 		Read the modprobe sysctl.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_read_modprobe_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_kernel_t, sysctl_modprobe_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_kernel_t:dir r_dir_perms;
	allow $1 sysctl_modprobe_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_modprobe_sysctl">
##	<desc>
##		Read and write the modprobe sysctl.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_modprobe_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_kernel_t, sysctl_modprobe_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_kernel_t:dir r_dir_perms;
	allow $1 sysctl_modprobe_t:file rw_file_perms;
')

########################################
## <interface name="kernel_read_kernel_sysctl">
##	<desc>
##		Read generic kernel sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_read_kernel_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_kernel_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_kernel_t:dir r_dir_perms;
	allow $1 sysctl_kernel_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_kernel_sysctl">
##	<desc>
## 		Read and write generic kernel sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_kernel_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_kernel_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_kernel_t:dir r_dir_perms;
	allow $1 sysctl_kernel_t:file rw_file_perms;
')

########################################
## <interface name="kernel_read_fs_sysctl">
##	<desc>
##		Read filesystem sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_read_fs_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_fs_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_fs_t:dir r_dir_perms;
	allow $1 sysctl_fs_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_fs_sysctl">
##	<desc>
##		Read and write fileystem sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_fs_sysctl',`
	gen_require(`
		type proc_t, sysctl_t, sysctl_fs_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_t:dir r_dir_perms;
	allow $1 sysctl_fs_t:dir r_dir_perms;
	allow $1 sysctl_fs_t:file rw_file_perms;
')

########################################
## <interface name="kernel_read_irq_sysctl">
##	<desc>
## 		Read IRQ sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_read_irq_sysctl',`
	gen_require(`
		type proc_t, sysctl_irq_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_irq_t:dir r_dir_perms;
	allow $1 sysctl_irq_t:file r_file_perms;
')

########################################
## <interface name="kernel_rw_irq_sysctl">
##	<desc>
## 		Read and write IRQ sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
##
#
interface(`kernel_rw_irq_sysctl',`
	gen_require(`
		type proc_t, sysctl_irq_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 sysctl_irq_t:dir r_dir_perms;
	allow $1 sysctl_irq_t:file rw_file_perms;
')

########################################
#
# kernel_read_rpc_sysctl(domain)
#
interface(`kernel_read_rpc_sysctl',`
	gen_require(`
		type proc_t, proc_net_t, sysctl_rpc_t;
		class dir r_dir_perms;
		class file r_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 proc_net_t:dir search;
	allow $1 sysctl_rpc_t:dir r_dir_perms;
	allow $1 sysctl_rpc_t:file r_file_perms;
')

########################################
#
# kernel_rw_rpc_sysctl(domain)
#
interface(`kernel_rw_rpc_sysctl',`
	gen_require(`
		type proc_t, proc_net_t, sysctl_rpc_t;
		class dir r_dir_perms;
		class file rw_file_perms;
	')

	allow $1 proc_t:dir search;
	allow $1 proc_net_t:dir search;
	allow $1 sysctl_rpc_t:dir r_dir_perms;
	allow $1 sysctl_rpc_t:file rw_file_perms;
')

########################################
## <interface name="kernel_read_all_sysctl">
##	<desc>
## 		Allow caller to read all sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_read_all_sysctl',`
	kernel_read_device_sysctl($1)
	kernel_read_vm_sysctl($1)
	kernel_read_net_sysctl($1)
	kernel_read_unix_sysctl($1)
	kernel_read_hotplug_sysctl($1)
	kernel_read_modprobe_sysctl($1)
	kernel_read_kernel_sysctl($1)
	kernel_read_fs_sysctl($1)
	kernel_read_irq_sysctl($1)
	kernel_read_rpc_sysctl($1)
')

########################################
## <interface name="kernel_rw_all_sysctl">
##	<desc>
## 		Read and write all sysctls.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_rw_all_sysctl',`
	kernel_rw_device_sysctl($1)
	kernel_rw_vm_sysctl($1)
	kernel_rw_net_sysctl($1)
	kernel_rw_unix_sysctl($1)
	kernel_rw_hotplug_sysctl($1)
	kernel_rw_modprobe_sysctl($1)
	kernel_rw_kernel_sysctl($1)
	kernel_rw_fs_sysctl($1)
	kernel_rw_irq_sysctl($1)
	kernel_rw_rpc_sysctl($1)
')

########################################
## <interface name="kernel_kill_unlabeled">
##	<desc>
##		Send a kill signal to unlabeled processes.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_kill_unlabeled',`
	gen_require(`
		type unlabeled_t;
		class process sigkill;
	')

	allow $1 unlabeled_t:process sigkill;
')

########################################
## <interface name="kernel_signal_unlabeled">
##	<desc>
##		Send general signals to unlabeled processes.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_signal_unlabeled',`
	gen_require(`
		type unlabeled_t;
		class process signal;
	')

	allow $1 unlabeled_t:process signal;
')

########################################
## <interface name="kernel_signull_unlabeled">
##	<desc>
##		Send a null signal to unlabeled processes.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_signull_unlabeled',`
	gen_require(`
		type unlabeled_t;
		class process signull;
	')

	allow $1 unlabeled_t:process signull;
')

########################################
## <interface name="kernel_sigstop_unlabeled">
##	<desc>
##		Send a stop signal to unlabeled processes.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_sigstop_unlabeled',`
	gen_require(`
		type unlabeled_t;
		class process sigstop;
	')

	allow $1 unlabeled_t:process sigstop;
')

########################################
## <interface name="kernel_sigchld_unlabeled">
##	<desc>
##		Send a child terminated signal to unlabeled processes.
##	</desc>
##	<param name="domain">
##		The type of the process performing this action.
##	</param>
## </interface>
#
interface(`kernel_sigchld_unlabeled',`
	gen_require(`
		type unlabeled_t;
		class process sigchld;
	')

	allow $1 unlabeled_t:process sigchld;
')

########################################
## <interface name="kernel_dontaudit_getattr_unlabeled_blk_dev">
##	<desc>
## 		Do not audit attempts by caller to get attributes for 
## 		unlabeled block devices.
##	</desc>
##	<param name="domain">
##		The process type not to audit.
##	</param>
## </interface>
#
interface(`kernel_dontaudit_getattr_unlabeled_blk_dev',`
	gen_require(`
		type unlabeled_t;
		class process getattr;
	')

	allow $1 unlabeled_t:blk_file getattr;
')

########################################
## <interface name="kernel_relabel_unlabeled">
##	<desc>
## 		Allow caller to relabel unlabeled objects.
##	</desc>
##	<param name="domain">
##		The process type relabeling the objects.
##	</param>
## </interface>
#
interface(`kernel_relabel_unlabeled',`
	gen_require(`
		type unlabeled_t;
		class dir { getattr relabelfrom };
		class file { getattr relabelfrom };
		class lnk_file { getattr relabelfrom };
		class fifo_file { getattr relabelfrom };
		class sock_file { getattr relabelfrom };
		class chr_file { getattr relabelfrom };
		class blk_file { getattr relabelfrom };
	')

	allow $1 unlabeled_t:dir_file_class_set { getattr relabelfrom };
')

## </module>
